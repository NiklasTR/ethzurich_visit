---
title: "KRAS_libdesign"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

load packages
```{r, message=FALSE}
library(readxl)
library(dplyr)
library(tidyr)
library(readr)
library(ggplot2)
```

load KRAS loci of the plasmid
```{r}
kras <- read_excel("~/zurich/local_data/KRAS G12D Kasette.xlsx")
kras$`K-Ras G12D` %>% substr(4,45) #substring to remove AUG from sequence
kras$`K-Ras wt`
```

load the first generation of possible sgRNA design for the given region. The sgRNAs vary in size between 17 and 23 nucleotides length. They were designed under loose criteria, tolerating NAG PAMs and non G starting sgRNA designs. 
```{r,results='hide', message=FALSE}
sgrna_doench <- read_delim("~/zurich/sgrna-designs.txt", 
    "\t", escape_double = FALSE, trim_ws = TRUE)
#load E-CRISP data
sgrna_ecrisp <- read_delim("~/zurich/local_data/ecrisp_plasmid/all_results_together_loose_1624.tab", 
    "\t", escape_double = FALSE, trim_ws = TRUE)
sgrna_ecrisp <- rbind(sgrna_ecrisp, read_delim("~/zurich/local_data/ecrisp_plasmid/all_results_together_loose_1723.tab", 
    "\t", escape_double = FALSE, trim_ws = TRUE))
sgrna_ecrisp <- rbind(sgrna_ecrisp, read_delim("~/zurich/local_data/ecrisp_plasmid/all_results_together_medium_1624.tab", 
    "\t", escape_double = FALSE, trim_ws = TRUE))
sgrna_ecrisp <- rbind(sgrna_ecrisp, read_delim("~/zurich/local_data/ecrisp_plasmid/all_results_together_medium_1723.tab", 
    "\t", escape_double = FALSE, trim_ws = TRUE))
```

remove duplicate sgRNA designs, check if they cover the G12D mutation in some region of their sequence
```{r}
sgrna_ecrisp <- sgrna_ecrisp %>% group_by(`Nucleotide sequence`) %>% 
  sample_n(1) %>%
  filter(Start >= 3) %>% 
  filter(32 %in% Start:End)
  
sgrna_ecrisp %>% 
  ggplot(aes(Length)) + 
  geom_density(bins = 20) + 
  theme_minimal()

head(sgrna_ecrisp)
```

```{r}

```



